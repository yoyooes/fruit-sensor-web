<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <title>Fruit Details</title>
  <link rel="stylesheet" href="style.css" />
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
  <div class="detail-shell">
    <h1 class="page-title" id="fruitTitle">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡πÑ‡∏°‡πâ</h1>

    <div id="fruitMeta" class="fruit-meta">‚Äì</div>

    <div class="status-row">
      <div class="status-card">
        <div class="status-label">Ripeness Index</div>
        <div class="status-value" id="ripenessValue">‚Äì</div>
      </div>
      <div class="status-card">
        <div class="status-label">Status</div>
        <div class="pill" id="statusPill">‚Äì</div>
      </div>
    </div>

    <div class="chart-wrap">
      <canvas id="ripenessChart"></canvas>
    </div>

    <div class="detail-buttons">
      <button class="btn back-btn" onclick="window.location.href='page2.html'">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ú‡∏•‡πÑ‡∏°‡πâ</button>
      <button class="btn neon-btn start" onclick="window.location.href='index.html'">üè† ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
    </div>
  </div>

  <script>
    // 1) ‡∏≠‡πà‡∏≤‡∏ô‡∏û‡∏≤‡∏£‡∏≤‡∏°‡∏¥‡πÄ‡∏ï‡∏≠‡∏£‡πå ?fruit=
    const params = new URLSearchParams(location.search);
    const fruit = (params.get('fruit') || 'banana').toLowerCase();

    // 2) ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡πÅ‡∏ï‡πà‡∏•‡∏∞‡∏ú‡∏•‡πÑ‡∏°‡πâ
    const FRUIT_INFO = {
      banana: {
        name: 'Banana üçå',
        color: '#ffe600',
        note: '‡∏Å‡∏•‡πâ‡∏ß‡∏¢‡∏™‡∏∏‡∏Å‡πÄ‡∏£‡πá‡∏ß ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏¥‡∏ô‡∏™‡∏î/‡∏™‡∏°‡∏π‡∏ó‡∏ï‡∏µ‡πâ ‡πÄ‡∏Å‡πá‡∏ö‡∏≠‡∏∏‡∏ì‡∏´‡∏†‡∏π‡∏°‡∏¥‡∏´‡πâ‡∏≠‡∏á ‡∏´‡∏•‡∏µ‡∏Å‡πÄ‡∏•‡∏µ‡πà‡∏¢‡∏á‡πÅ‡∏î‡∏î',
        threshold: 70,
        series: [20,30,35,42,50,58,65,70,78,84,90],
      },
      mango: {
        name: 'Mango ü•≠',
        color: '#ff9900',
        note: '‡∏°‡∏∞‡∏°‡πà‡∏ß‡∏á‡∏™‡∏∏‡∏Å‡∏õ‡∏≤‡∏ô‡∏Å‡∏•‡∏≤‡∏á ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏¥‡∏ô‡∏™‡∏î/‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô ‡πÅ‡∏ä‡πà‡πÄ‡∏¢‡πá‡∏ô‡∏ä‡πà‡∏ß‡∏á‡∏™‡∏∏‡∏Å‡∏ä‡πâ‡∏≤',
        threshold: 65,
        series: [15,22,28,36,45,55,63,69,73,78,82],
      },
      durian: {
        name: 'Durian üå∞',
        color: '#6eff00',
        note: '‡∏ó‡∏∏‡πÄ‡∏£‡∏µ‡∏¢‡∏ô‡∏™‡∏∏‡∏Å‡∏ä‡πâ‡∏≤ ‡∏Ñ‡∏ß‡∏£‡∏™‡∏±‡∏á‡πÄ‡∏Å‡∏ï‡∏Å‡∏•‡∏¥‡πà‡∏ô/‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ô‡∏¥‡πà‡∏° ‡πÄ‡∏´‡∏°‡∏≤‡∏∞‡∏Å‡∏¥‡∏ô‡∏ä‡πà‡∏ß‡∏á‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏Ñ‡∏£‡∏µ‡∏°',
        threshold: 70,
        series: [10,16,20,30,40,52,60,68,72,79,85],
      }
    };

    // 3) ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÇ‡∏õ‡∏£‡πÑ‡∏ü‡∏•‡πå
    const P = FRUIT_INFO[fruit] || FRUIT_INFO.banana;

    // 4) ‡∏ï‡∏±‡πâ‡∏á‡∏´‡∏±‡∏ß‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á + ‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏¢‡πà‡∏≠
    document.getElementById('fruitTitle').textContent = `‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡∏•‡πÑ‡∏°‡πâ ‚Äì ${P.name}`;
    document.getElementById('fruitMeta').textContent = P.note;

    // 5) ‡∏Ñ‡πà‡∏≤ index ‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î + ‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏∏‡∏Å/‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏Å
    const latest = P.series[P.series.length - 1];
    document.getElementById('ripenessValue').textContent = `${latest}`;

    const pill = document.getElementById('statusPill');
    const isRipe = latest >= P.threshold;
    pill.textContent = isRipe ? '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏™‡∏∏‡∏Å' : '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏™‡∏∏‡∏Å';
    pill.classList.remove('ok', 'warn');
    pill.classList.add(isRipe ? 'ok' : 'warn');

    // 6) ‡∏ß‡∏≤‡∏î‡∏Å‡∏£‡∏≤‡∏ü‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏Ç‡∏≠‡∏á‡∏ú‡∏•‡πÑ‡∏°‡πâ‡∏ô‡∏±‡πâ‡∏ô
    const labels = Array.from({length: P.series.length}, (_, i) => `t${i}`);
    const ctx = document.getElementById('ripenessChart').getContext('2d');
    new Chart(ctx, {
      type: 'line',
      data: {
        labels,
        datasets: [{
          label: `${P.name} ‚Äì Ripeness Index`,
          data: P.series,
          tension: 0.25,
          fill: true,
          backgroundColor: P.color + '22',
          borderColor: P.color,
          borderWidth: 3,
          pointRadius: 3,
          pointHoverRadius: 5
        }]
      },
      options: {
        plugins: {
          legend: { labels: { color: '#ffffff' } },
          tooltip: { enabled: true }
        },
        scales: {
          x: { ticks: { color: '#cfe3ff' }, grid: { color: 'rgba(255,255,255,0.08)' } },
          y: { suggestedMin: 0, suggestedMax: 100, ticks: { color: '#cfe3ff' }, grid: { color: 'rgba(255,255,255,0.08)' } }
        }
      }
    });
  </script>
</body>
</html>
